{% autoescape false %}
{{ "{% extends 'base.html.twig' %}" }}

{{ '{% block title %}' ~ entity_class_name ~ ' Search{% endblock %}' }}

{{ " {% block pageheader %} "}}
    <h1>{{ entity_class_name }} Search</h1>
    {{ '{% if ' ~ entity_twig_var_plural  ~ "|length %}" }}
    <p class="count">
        Displaying {{ '{{ ' ~ entity_twig_var_plural  ~ "|length }}" }} {{ entity_twig_var_plural }} of {{ '{{ ' ~ entity_twig_var_plural  ~ ".getTotalItemCount }}" }} total.
    </p>
	{{ '{% endif %}' }}
{{ " {% endblock %} "}}

{{ "{% block body %}" }}

    <form method="get" action="{{ "{{ path('" ~ route_name ~ "_search') }}" }}" class="form-horizontal">
        <fieldset>
            <legend>Search</legend>
            <div class='form-group'>
                <label class='col-sm-2 control-label' for='q'>Search term</label>
                <div class='col-sm-10'>
                    <div class='input-group'>
                        <input type='text' name='q' id='q' class='form-control' value='{{ "{{ q }}" }}'>
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="submit">
                                <span class='glyphicon glyphicon-search'></span>
                                Search
                            </button>
                        </span>
                    </div>
                </div>
            </div>
            <p>	Full text searching options, if available:</p>
            <ul>
                <li><code>shakespeare</code> - shakespeare should be present, but might not be</li>
                <li><code>shakes*</code> - words starting with shakes should be present</li>
                <li><code>+agnes</code> - agnes must be present</li>
                <li><code>-fisher</code> - fisher must not be present</li>
                <li>Combinations are OK: <code>+agnes -fisher</code> finds Anges who isn't a Fisher</li>
                <li>Phrases are OK: <code>"nee agnes"</code> finds rows that contain the literal phrase.
            </ul>
        </fieldset>
    </form>

	{{ '{% if ' ~ entity_twig_var_plural  ~ "|length %}" }}
<table class="table table-bordered table-condensed table-hover table-striped">
    <thead>
        <tr>
            <th>ID</th>

            {%- for field in mapped_field_names %}

                <th>{{ field|title }}</th>
            {%- endfor %}

        </tr>
    </thead>
    <tbody>
        {{ '{% for ' ~ entity_var_singular ~ ' in ' ~ entity_var_plural ~ ' %}' }}
        <tr>

            <td>
                <a href="{{ "{{ path('" ~ route_name ~ "_show', { 'id': " ~ entity_twig_var_singular ~ ".id" ~" }) }}" }}">
                    {{ '{{ ' ~ entity_twig_var_singular ~ '.id' ~ ' }}' }}
                </a>
            </td>

            {%- for field in mapped_field_names %}
                {%- if field in field_mappings|keys %}
                    {%- set mapping = field_mappings[field] %}

                    {%- if mapping.type in ['datetime'] %}

                        <td>{{ '{% if ' ~ entity_var_singular ~ '.' ~ field ~ ' %}{{ ' ~ entity_singularized ~ '.' ~ field ~ '|date) }}{% endif %}' }}</td>

                    {%- elseif mapping.type in ['date'] %}

                        <td>{{ '{% if ' ~ entity_var_singular ~ '.' ~ field ~ ' %}{{ ' ~ entity_singularized ~ '.' ~ field ~ '|date(\'Y-m-d\') }}{% endif %}' }}</td>

                    {%- elseif mapping.type in ['time'] %}

                        <td>{{ '{% if ' ~ entity_var_singular ~ '.' ~ field ~ ' %}{{ ' ~ entity_singularized ~ '.' ~ field ~ '|date(\'H:i:s\') }}{% endif %}' }}</td>

                    {%- elseif mapping.type in ['array'] %}

                        <td>{{ '{% if ' ~ entity_var_singular ~ '.' ~ field ~ ' %}{{ ' ~ entity_singularized ~ '.' ~ field ~ '|join(\', \') }}{% endif %}' }}</td>

                    {%- elseif mapping.type in ['boolean'] %}

                        <td>{{ '{% if ' ~ entity_var_singular ~ '.' ~ field ~ ' %}Yes{% else %}No{% endif %}' }}</td>

                    {% else %}

                        <td>
                            {{ '{{ ' ~ entity_var_singular ~ '.' ~ field ~ ' }}' }}
                        </td>

                    {%- endif %}

                {% else %}
                    {% set relation = relations[field] %}

                    <td>
                        <a href='{{ '{{ path("' ~ relation['route_name'] ~ '_show", {"id": ' ~ entity_var_singular ~ '.' ~ field ~ '.id}) }}' }}'>
                            {{ '{{ ' ~ entity_var_singular ~ '.' ~ field ~ ' }}' }}
                        </a>
                    </td>
                {% endif %}

            {%- endfor %}

        </tr>
        {{ '{% endfor %}' }}
    </tbody>
</table>


    <div class="navigation">
        {{ '{{ knp_pagination_render(' ~ entity_twig_var_plural ~ ') }}' }}
    </div>
	{{ '{% endif %}' }}

{{ "{% endblock %}" }}

{% endautoescape %}
